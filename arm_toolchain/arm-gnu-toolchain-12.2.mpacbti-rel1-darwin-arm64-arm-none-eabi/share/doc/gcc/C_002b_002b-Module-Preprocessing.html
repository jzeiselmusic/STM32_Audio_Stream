<html lang="en">
<head>
<title>C++ Module Preprocessing - Using the GNU Compiler Collection (GCC)</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Using the GNU Compiler Collection (GCC)">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="C_002b_002b-Modules.html#C_002b_002b-Modules" title="C++ Modules">
<link rel="prev" href="C_002b_002b-Module-Mapper.html#C_002b_002b-Module-Mapper" title="C++ Module Mapper">
<link rel="next" href="C_002b_002b-Compiled-Module-Interface.html#C_002b_002b-Compiled-Module-Interface" title="C++ Compiled Module Interface">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1988-2022 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``Funding Free Software'', the Front-Cover
Texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.

(a) The FSF's Front-Cover Text is:

     A GNU Manual

(b) The FSF's Back-Cover Text is:

     You have freedom to copy and modify this GNU Manual, like GNU
     software.  Copies published by the Free Software Foundation raise
     funds for GNU development.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="C++-Module-Preprocessing"></a>
<a name="C_002b_002b-Module-Preprocessing"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="C_002b_002b-Compiled-Module-Interface.html#C_002b_002b-Compiled-Module-Interface">C++ Compiled Module Interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="C_002b_002b-Module-Mapper.html#C_002b_002b-Module-Mapper">C++ Module Mapper</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="C_002b_002b-Modules.html#C_002b_002b-Modules">C++ Modules</a>
<hr>
</div>

<h4 class="subsection">3.23.2 Module Preprocessing</h4>

<p><a name="index-C_002b_002b-Module-Preprocessing-3683"></a>
Modules affect preprocessing because of header units and include
translation.  Some uses of the preprocessor as a separate step either
do not produce a correct output, or require CMIs to be available.

 <p>Header units import macros.  These macros can affect later conditional
inclusion, which therefore can cascade to differing import sets.  When
preprocessing, it is necessary to load the CMI.  If a header unit is
unavailable, the preprocessor issues a warning and continue (when
not just preprocessing, an error is emitted).  Detecting such imports
requires preprocessor tokenization of the input stream to phase 4
(macro expansion).

 <p>Include translation converts <code>#include</code>, <code>#include_next</code> and
<code>#import</code> directives to internal <code>import</code> declarations. 
Whether a particular directive is translated is controlled by the
module mapper.  Header unit names are canonicalized during
preprocessing.

 <p>Dependency information can be emitted for macro import, extending the
functionality of <samp><span class="option">-MD</span></samp> and <samp><span class="option">-MMD</span></samp> options.  Detection of
import declarations also requires phase 4 preprocessing, and thus
requires full preprocessing (or compilation).

 <p>The <samp><span class="option">-M</span></samp>, <samp><span class="option">-MM</span></samp> and <samp><span class="option">-E -fdirectives-only</span></samp> options halt
preprocessing before phase 4.

 <p>The <samp><span class="option">-save-temps</span></samp> option uses <samp><span class="option">-fdirectives-only</span></samp> for
preprocessing, and preserve the macro definitions in the preprocessed
output.  Usually you also want to use this option when explicitly
preprocessing a header-unit, or consuming such preprocessed output:

<pre class="smallexample">     g++ -fmodules-ts -E -fdirectives-only my-header.hh -o my-header.ii
     g++ -x c++-header -fmodules-ts -fpreprocessed -fdirectives-only my-header.ii
</pre>
 </body></html>

