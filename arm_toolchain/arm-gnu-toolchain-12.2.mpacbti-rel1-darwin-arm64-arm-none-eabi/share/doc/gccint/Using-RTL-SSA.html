<html lang="en">
<head>
<title>Using RTL SSA - GNU Compiler Collection (GCC) Internals</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Compiler Collection (GCC) Internals">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="RTL-SSA.html#RTL-SSA" title="RTL SSA">
<link rel="next" href="RTL-SSA-Instructions.html#RTL-SSA-Instructions" title="RTL SSA Instructions">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1988-2022 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``Funding Free Software'', the Front-Cover
Texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.

(a) The FSF's Front-Cover Text is:

     A GNU Manual

(b) The FSF's Back-Cover Text is:

     You have freedom to copy and modify this GNU Manual, like GNU
     software.  Copies published by the Free Software Foundation raise
     funds for GNU development.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Using-RTL-SSA"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="RTL-SSA-Instructions.html#RTL-SSA-Instructions">RTL SSA Instructions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="RTL-SSA.html#RTL-SSA">RTL SSA</a>
<hr>
</div>

<h4 class="subsection">14.21.1 Using RTL SSA in a pass</h4>

<p>A pass that wants to use the RTL SSA form should start with the following:

<pre class="smallexample">     #define INCLUDE_ALGORITHM
     #define INCLUDE_FUNCTIONAL
     #include "config.h"
     #include "system.h"
     #include "coretypes.h"
     #include "backend.h"
     #include "rtl.h"
     #include "df.h"
     #include "rtl-ssa.h"
</pre>
 <p>All the RTL SSA code is contained in the <code>rtl_ssa</code> namespace,
so most passes will then want to do:

<pre class="smallexample">     using namespace rtl_ssa;
</pre>
 <p>However, this is purely a matter of taste, and the examples in the rest of
this section do not require it.

 <p>The RTL SSA represention is an optional on-the-side feature that applies
on top of the normal RTL instructions.  It is currently local to individual
RTL passes and is not maintained across passes.

 <p>However, in order to allow the RTL SSA information to be preserved across
passes in future, `<samp><span class="samp">crtl-&gt;ssa</span></samp>' points to the current function's
SSA form (if any).  Passes that want to use the RTL SSA form should
first do:

<pre class="smallexample">     crtl-&gt;ssa = new rtl_ssa::function_info (<var>fn</var>);
</pre>
 <p>where <var>fn</var> is the function that the pass is processing. 
(Passes that are <code>using namespace rtl_ssa</code> do not need
the `<samp><span class="samp">rtl_ssa::</span></samp>'.)

 <p>Once the pass has finished with the SSA form, it should do the following:

<pre class="smallexample">     free_dominance_info (CDI_DOMINATORS);
     if (crtl-&gt;ssa-&gt;perform_pending_updates ())
       cleanup_cfg (0);
     
     delete crtl-&gt;ssa;
     crtl-&gt;ssa = nullptr;
</pre>
 <p>The <code>free_dominance_info</code> call is necessary because
dominance information is not currently maintained between RTL passes. 
The next two lines commit any changes to the RTL instructions that
were queued for later; see the comment above the declaration of
<code>perform_pending_updates</code> for details.  The final two lines
discard the RTL SSA form and free the associated memory.

 </body></html>

